# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Telegram-–±–æ—Ç–∞ FindOrigin

## –≠—Ç–∞–ø 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ ‚úÖ

- [x] –°–æ–∑–¥–∞—Ç—å Next.js –ø—Ä–æ–µ–∫—Ç —Å App Router
- [x] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å TypeScript
- [x] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫
- [x] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env.local`)

## –≠—Ç–∞–ø 2: Webhook –¥–ª—è Telegram ‚úÖ

- [x] –°–æ–∑–¥–∞—Ç—å API route: `app/api/webhook/route.ts`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É POST-–∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç Telegram
- [x] –ò–∑–≤–ª–µ–∫–∞—Ç—å `chat.id` –∏ `text` –∏–∑ `update.message`
- [x] –í–æ–∑–≤—Ä–∞—â–∞—Ç—å `200 OK` –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
- [x] –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ `sendMessage`

## –≠—Ç–∞–ø 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö ‚úÖ

- [x] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ç–µ–∫—Å—Ç –∏–ª–∏ —Å—Å—ã–ª–∫–∞)
- [x] –°–æ–∑–¥–∞—Ç—å –ø–∞—Ä—Å–µ—Ä –¥–ª—è —Å—Å—ã–ª–æ–∫ –Ω–∞ Telegram-–ø–æ—Å—Ç—ã (`t.me/...`)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ Telegram-–ø–æ—Å—Ç–æ–≤
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞

## –≠—Ç–∞–ø 4: AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ‚úÖ

- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å OpenAI GPT-4o-mini
- [x] AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 2-3 –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –∏–∑ —Ç–µ–∫—Å—Ç–∞
- [x] Fallback –Ω–∞ –ø–µ—Ä–≤—ã–µ 100 —Å–∏–º–≤–æ–ª–æ–≤ —Ç–µ–∫—Å—Ç–∞

## –≠—Ç–∞–ø 5: –ü–æ–∏—Å–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ ‚úÖ

- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Google Custom Search API
- [x] Fallback –Ω–∞ DuckDuckGo
- [x] –ü–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∑–∞–ø—Ä–æ—Å–∞–º
- [x] –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

## –≠—Ç–∞–ø 6: AI-–∞–Ω–∞–ª–∏–∑ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ ‚úÖ

- [x] –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å `lib/ai.ts`
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å OpenAI GPT-4o-mini
- [x] –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–ø—Ç –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- [x] –°—Ä–∞–≤–Ω–∏—Ç—å —Å–º—ã—Å–ª –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏
- [x] –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ—Ü–µ–Ω–∫—É —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (0‚Äì100%)
- [x] –†–∞–Ω–∂–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏

## –≠—Ç–∞–ø 7: –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ ‚úÖ

- [x] –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- [x] –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (–¥–æ 3 —Å—Å—ã–ª–æ–∫)
- [x] –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—Ü–µ–Ω–∫—É —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞–µ–≤ –∫–æ–≥–¥–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

## –≠—Ç–∞–ø 8: –î–µ–ø–ª–æ–π –Ω–∞ Vercel ‚úÖ

- [x] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –Ω–∞ Vercel
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Vercel
- [x] –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –ø—Ä–æ–µ–∫—Ç
- [x] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å webhook –≤ Telegram:
  ```powershell
  Invoke-RestMethod -Uri "https://api.telegram.org/bot<TOKEN>/setWebhook?url=https://<APP>.vercel.app/api/webhook"
  ```

## –≠—Ç–∞–ø 9: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞ üîÑ

- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ edge-cases (—É—Å—Ç–æ–π—á–∏–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥ JSON, DuckDuckGo 403)
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞

## –≠—Ç–∞–ø 10: Telegram Mini App (TMA)

–†–∞–∑–±–∏–≤–∫–∞ –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ —à–∞–≥–∏:

- [x] **10.1** –í—ã–Ω–µ—Å—Ç–∏ –ø–∞–π–ø–ª–∞–π–Ω –∞–Ω–∞–ª–∏–∑–∞ –≤ `lib/analysisPipeline.ts`
- [x] **10.2** –í–∞–ª–∏–¥–∞—Ü–∏—è initData: —Å–æ–∑–¥–∞—Ç—å `lib/telegramWebApp.ts` (validate + getUserId)
- [x] **10.3** API POST `/api/tma/analyze`: –ø—Ä–æ–≤–µ—Ä–∫–∞ initData, –≤—ã–∑–æ–≤ `runAnalysis`, JSON-–æ—Ç–≤–µ—Ç
- [x] **10.4** Layout –¥–ª—è TMA: `app/tma/layout.tsx` (viewport, —Ç–µ–º–∞ –ø–æ–¥ Telegram, –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ UI)
- [x] **10.5** –°—Ç—Ä–∞–Ω–∏—Ü–∞ TMA: `app/tma/page.tsx` ‚Äî —Ñ–æ—Ä–º–∞ (textarea + –∫–Ω–æ–ø–∫–∞ ¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å¬ª)
- [x] **10.6** –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤—ã–∑—ã–≤–∞—Ç—å `/api/tma/analyze` —Å `text` –∏ `initData` –∏–∑ `Telegram.WebApp.initData`
- [x] **10.7** –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É (—Å–ø–∏–Ω–Ω–µ—Ä/—Å–æ–æ–±—â–µ–Ω–∏–µ) –ø–æ–∫–∞ –∂–¥—ë–º –æ—Ç–≤–µ—Ç API
- [x] **10.8** –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ, —Å–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (—Å—Å—ã–ª–∫–∏)
- [x] **10.9** –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ (–∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç, –ª–∏–º–∏—Ç, –Ω–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏ —Ç.–¥.)
- [x] **10.10** –í –±–æ—Ç–µ: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Menu Button –∏–ª–∏ –∫–æ–º–∞–Ω–¥—É —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ TMA (URL –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- [ ] **10.11** –í README: –æ–ø–∏—Å–∞—Ç—å, –∫–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å TMA –∏ –∫–∞–∫–∏–µ env –Ω—É–∂–Ω—ã

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
FindOrigin/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ webhook/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ route.ts        # Telegram webhook handler
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tma/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ analyze/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ route.ts    # POST /api/tma/analyze –¥–ª—è Mini App
‚îÇ   ‚îú‚îÄ‚îÄ tma/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx          # layout –¥–ª—è Mini App (viewport, —Ç–µ–º–∞)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx            # UI: —Ñ–æ—Ä–º–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –æ—à–∏–±–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ telegram.ts             # Telegram API —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ telegramWebApp.ts       # –í–∞–ª–∏–¥–∞—Ü–∏—è initData Mini App
‚îÇ   ‚îú‚îÄ‚îÄ analysisPipeline.ts    # –ü–∞–π–ø–ª–∞–π–Ω: –ø–∞—Ä—Å–∏–Ω–≥ ‚Üí –ø–æ–∏—Å–∫ ‚Üí AI-–∞–Ω–∞–ª–∏–∑
‚îÇ   ‚îú‚îÄ‚îÄ parser.ts               # –ü–∞—Ä—Å–∏–Ω–≥ —Ç–µ–∫—Å—Ç–∞ –∏ —Å—Å—ã–ª–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ search.ts               # Google Search API
‚îÇ   ‚îî‚îÄ‚îÄ ai.ts                   # OpenAI GPT-4o-mini
‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îî‚îÄ‚îÄ index.ts                # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ bot.js                      # –õ–æ–∫–∞–ª—å–Ω—ã–π –±–æ—Ç (polling)
‚îú‚îÄ‚îÄ .env.local                  # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ PROJECT.md                  # –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îú‚îÄ‚îÄ PLAN.md                     # –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ package.json
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
|------------|----------|-------------|
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω –æ—Ç @BotFather | –î–∞ |
| `OPENAI_API_KEY` –∏–ª–∏ `OPENROUTER_API_KEY` | –ö–ª—é—á OpenAI –∏–ª–∏ OpenRouter | –î–∞ (–æ–¥–∏–Ω –∏–∑ –¥–≤—É—Ö) |
| `OPENAI_MODEL` –∏–ª–∏ `OPENROUTER_MODEL` | –ú–æ–¥–µ–ª—å (–Ω–∞–ø—Ä. nvidia/..., openai/gpt-oss-120b) | –ù–µ—Ç (fallback: gpt-4o-mini) |
| `OPENAI_BASE_URL` | URL API (–¥–ª—è OpenRouter: https://openrouter.ai/api/v1) | –ù–µ—Ç (–ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ OPENROUTER_API_KEY) |
| `GOOGLE_API_KEY` | –ö–ª—é—á Google Custom Search API | –ù–µ—Ç* |
| `GOOGLE_SEARCH_ENGINE_ID` | ID –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞ Google | –ù–µ—Ç* |

*–ë–µ–∑ Google –∫–ª—é—á–µ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è DuckDuckGo (–Ω–∞ Vercel —á–∞—Å—Ç–æ 403 ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Google)

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```json
{
  "dependencies": {
    "next": "^14.2.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "openai": "^4.28.0"
  }
}
```
